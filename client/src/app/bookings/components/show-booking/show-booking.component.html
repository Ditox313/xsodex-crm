<app-header-app-layout [title]="title"></app-header-app-layout>
<p-toast></p-toast>
<loader *ngIf="isLoadingSelector$ | async"></loader>



<div class="show-booking" *ngIf="currentBooking && currentUser">
    <div class="info">
        <div class="part_1">
            <h3>Информация</h3>

            <div>
                <span>Номер брони:</span>
                <span> №{{currentBooking.order}}</span>
            </div>

            <div>
                <span>Ответственный:</span>
                <span> {{currentUser.secondName}} {{currentUser.name}} {{currentUser.lastName}}</span>
            </div>

            <div>
                <span>Статус:</span>
                <span *ngIf="currentBooking.status === 'В ожидании'"
                    style="display: inline-block; background-color: orange; padding: 3px 10px; color: #fff; border-radius: 3px;">
                    {{currentBooking.status}}</span>
                <span *ngIf="currentBooking.status === 'В аренде'"
                    style="display: inline-block; background-color: #194A9E; padding: 3px 10px; color: #fff; border-radius: 3px;">
                    {{currentBooking.status}}</span>
                <span *ngIf="currentBooking.status === 'Закрыта'"
                    style="display: inline-block; background-color: #F74B4C; padding: 3px 10px; color: #fff; border-radius: 3px;">
                    {{currentBooking.status}}</span>
            </div>

            <div>
                <span>Создана:</span>
                <span> {{currentBooking.date | date : 'dd.MM.yyyy HH:mm'}}</span>
            </div>

            <div *ngIf="currentBooking.client.type === 'fiz'">
                <span>Клиент:</span>
                <span> {{currentBooking.client.surname}} {{currentBooking.client.name}}
                    {{currentBooking.client.lastname}}</span>
            </div>
            <div *ngIf="currentBooking.client.type === 'law'">
                <span>Клиент:</span>
                <span> {{currentBooking.client.short_name}} {{currentBooking.client.name}}</span>
            </div>

            <div>
                <span>Телефон:</span>
                <span> №{{currentBooking.client.phone_1}}</span>
            </div>

            <div>
                <span>Автомобиль:</span>
                <span> {{currentBooking.car.marka}} {{currentBooking.car.model}}({{currentBooking.car.number}})</span>
            </div>

            <div>
                <span>Дата начала:</span>
                <span> {{currentBooking.booking_start | date : 'dd.MM.yyyy HH:mm'}}</span>
            </div>

            <div>
                <span>Дата окончания:</span>
                <span> {{currentBooking.booking_end | date : 'dd.MM.yyyy HH:mm'}}</span>
            </div>

            <div>
                <span>Тариф:</span>
                <span> {{currentBooking.tarifCheked}}</span>
            </div>



            <div *ngIf="currentBooking.tarifCheked === 'Город'">
                <span>Цена тарифа: </span>
                <span> {{currentBooking.tarif[0].tarif_price}} руб</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Межгород'">
                <span>Цена тарифа:</span>
                <span> {{currentBooking.tarif[1].tarif_price}} руб</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Россия'">
                <span>Цена тарифа:</span>
                <span> {{currentBooking.tarif[2].tarif_price}} руб</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Смешанный'" style="padding-left: 20px;">
                <span style="font-weight: 500; font-size: 12px;"> Город: Суток- {{currentBooking.tarif[0].booking_days}}
                    д; Цена
                    тарифа- {{currentBooking.tarif[0].tarif_price}} руб; Аренда-
                    {{currentBooking.tarif[0].booking_days*currentBooking.tarif[0].tarif_price}} руб</span><br>
                <span style="font-weight: 500 ; font-size: 12px;"> Межгород: Суток-
                    {{currentBooking.tarif[1].booking_days}} д; Цена
                    тарифа- {{currentBooking.tarif[1].tarif_price}} руб; Аренда-
                    {{currentBooking.tarif[1].booking_days*currentBooking.tarif[1].tarif_price}} руб</span><br>
                <span style="font-weight: 500; font-size: 12px; "> Россия: Суток-
                    {{currentBooking.tarif[2].booking_days}} д; Цена
                    тарифа- {{currentBooking.tarif[2].tarif_price}} руб; Аренда-
                    {{currentBooking.tarif[2].booking_days*currentBooking.tarif[2].tarif_price}} руб</span><br>
            </div>





            <div *ngIf="currentBooking.tarifCheked === 'Город'">
                <span>Суток:</span>
                <span> {{currentBooking.tarif[0].booking_days}} д</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Межгород'">
                <span>Суток:</span>
                <span> {{currentBooking.tarif[1].booking_days}} д</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Россия'">
                <span>Суток:</span>
                <span> {{currentBooking.tarif[2].booking_days}} д</span>
            </div>




            <div *ngIf="currentBooking.tarifCheked === 'Город' && currentBooking.tarif[0].dop_hours > 0">
                <span>Доп.часы:</span>
                <span> {{currentBooking.tarif[0].dop_hours}} ч</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Межгород' && currentBooking.tarif[1].dop_hours > 0">
                <span>Доп.часы:</span>
                <span> {{currentBooking.tarif[1].dop_hours}} ч</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Россия' && currentBooking.tarif[2].dop_hours > 0">
                <span>Доп.часы:</span>
                <span> {{currentBooking.tarif[2].dop_hours}} ч</span>
            </div>




            <div *ngIf="currentBooking.tarifCheked === 'Город' && currentBooking.tarif[0].dop_hours > 0">
                <span>Цена доп.часа: </span>
                <span> {{currentBooking.tarif[0].dop_hours_price}} руб</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Межгород' && currentBooking.tarif[1].dop_hours > 0">
                <span>Цена доп.часа:</span>
                <span> {{currentBooking.tarif[1].dop_hours_price}} руб</span>
            </div>

            <div *ngIf="currentBooking.tarifCheked === 'Россия' && currentBooking.tarif[2].dop_hours > 0">
                <span>Цена доп.часа:</span>
                <span> {{currentBooking.tarif[2].dop_hours_price}} руб</span>
            </div>


            <div>
                <span>Выдача:</span>
                <span> {{currentBooking.place_start}}</span>
            </div>

            <div>
                <span>Прием:</span>
                <span> {{currentBooking.place_end}}</span>
            </div>


            <div *ngIf="currentBooking.additional_services_price > 0">
                <span>Доп.услуги:</span><br>
                <div style="padding-left: 20px;">
                    <span style="font-weight: 500; font-size: 12px;"
                        *ngIf="currentBooking.additional_services[0].status">Детское
                        кресло: {{currentBooking.additional_services[0].price}} руб</span><br>
                    <span style="font-weight: 500; font-size: 12px;"
                        *ngIf="currentBooking.additional_services[1].status">Бустер:
                        {{currentBooking.additional_services[1].price}} руб</span><br>
                    <span style="font-weight: 500; font-size: 12px;"
                        *ngIf="currentBooking.additional_services[2].status">Видеорегистратор:
                        {{currentBooking.additional_services[2].price}} руб</span><br>
                    <span style="font-weight: 500; font-size: 12px;"
                        *ngIf="currentBooking.additional_services[3].status">Зарядное
                        устройство: {{currentBooking.additional_services[3].price}} руб</span><br>
                    <span style="font-weight: 500; font-size: 12px;"
                        *ngIf="currentBooking.additional_services[4].status">Антирадар:
                        {{currentBooking.additional_services[4].price}} руб</span><br>
                    <span style="font-weight: 500; font-size: 12px;"
                        *ngIf="currentBooking.additional_services[5].status">Мойка:
                        {{currentBooking.additional_services[5].price}} руб</span><br>
                </div>

            </div>
        </div>

        <div style="margin-top: auto;">
            <div class="part_2">
                <h3 style="color: #fff;">Рассчет</h3>

                <div>
                    <span>Аренда: </span>
                    <span>{{currentBooking.arenda}} руб</span>
                </div>

                <div>
                    <span>Залог: </span>
                    <span>{{currentBooking.zalog}} руб</span>
                </div>

                <div>
                    <span>Подача авто: </span>
                    <span>{{currentBooking.place_start_price}} руб</span>
                </div>

                <div>
                    <span>Прием авто: </span>
                    <span>{{currentBooking.place_end_price}} руб</span>
                </div>

                <div>
                    <span>Доп.услуги: </span>
                    <span>{{currentBooking.additional_services_price}} руб</span>
                </div>

                <div>
                    <span>Итого: </span>
                    <span>{{currentBooking.summaFull}} руб</span>
                </div>

                
            </div>

            <div class="part_3"  [class.isPaidFalse]="(currentBooking.summaFull - currentBooking.paidCount) > 0" [class.isPaidOk]="(currentBooking.summaFull - currentBooking.paidCount) === 0">
                <div>
                    <span>Общая скидка: </span>
                    <span>{{currentBooking.sale}} руб</span>
                </div>

                <div>
                    <span>Оплачено: </span>
                    <span>{{currentBooking.paidCount}} руб</span>
                </div>

                <div>
                    <span>Остаток: </span>
                    <span>{{currentBooking.summaFull - currentBooking.paidCount}} руб</span>
                </div>
            </div>
        </div>
    </div>

    <div class="pays">
        <h3>Платежи</h3>

        <div class="pays_wrap">
            1
        </div>
    </div>

    <div class="management">
        <h3>Управление</h3>
        
        <div class="management_wrap">
            <div class="management_btns">
                <span class="btn_paid_false" *ngIf="(currentBooking.summaFull - currentBooking.paidCount) > 0">Оплатить</span>
                <span class="btn_paid_ok"   *ngIf="(currentBooking.summaFull - currentBooking.paidCount) === 0">Оплачено</span>
                <span class="btn_act_create">Сформировать акт</span>
            </div>
        </div>
    </div>
</div>