<app-header-app-layout [title]="title"></app-header-app-layout>
<p-toast></p-toast>
<loader *ngIf="isLoadingSelector$ | async"></loader>



<div class="add-booking">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="add_booking_content">
            <div>
                <fieldset>
                    <label htmlFor="booking_start">Дата начала брони</label>
                    <input type="datetime-local" pInputText id="booking_start" formControlName="booking_start" placeholder="Введите значение"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['booking_start'].invalid && form.controls['booking_start'].touched}" 
                        (change)="checkedStartBookingDate($event)"/>
                
                
                    <div class="errorValidate" *ngIf="form.controls['booking_start'].invalid && form.controls['booking_start'].touched">
                        <p *ngIf="form.controls['booking_start'].errors && form.controls['booking_start'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="booking_end">Дата окончания брони</label>
                    <input type="datetime-local" pInputText id="booking_end" formControlName="booking_end" placeholder="Введите значение"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['booking_end'].invalid && form.controls['booking_end'].touched}" 
                        (change)="checkedEndBookingDate($event)"/>
                
                
                    <div class="errorValidate" *ngIf="form.controls['booking_end'].invalid && form.controls['booking_end'].touched">
                        <p *ngIf="form.controls['booking_end'].errors && form.controls['booking_end'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="car">Автомобиль</label>
                    <select id="car" formControlName="car"
                        [ngClass]="{'invalid': form.controls['car'].invalid && form.controls['car'].touched}" 
                        (ngModelChange)="checkedCar($event)">
                        <option value="" disabled selected>Выбрать ↷</option>
                        <option value="{{car._id}}" *ngFor="let car of carsList">
                            {{car.marka}} {{car.model}} ({{car.number}})</option>
                    </select>
                
                
                    <div class="errorValidate" *ngIf="form.controls['car'].invalid && form.controls['car'].touched">
                        <p *ngIf="form.controls['car'].errors && form.controls['car'].errors['required']">
                            Заполните поле
                        </p>
                    </div>
                </fieldset>


                <fieldset>
                    <label htmlFor="tarif">Тариф</label>
                    <select id="tarif" formControlName="tarif"
                        [ngClass]="{'invalid': form.controls['tarif'].invalid && form.controls['tarif'].touched}"
                        (ngModelChange)="checkedTarif($event)">
                        <option value="" disabled selected>Выбрать ↷</option>
                        <option value="Город">Город</option>
                        <option value="Межгород">Межгород</option>
                        <option value="Россия">Россия</option>
                        <option value="Смешанный">Смешанный</option>
                    </select>
                
                
                    <div class="errorValidate" *ngIf="form.controls['tarif'].invalid && form.controls['tarif'].touched">
                        <p *ngIf="form.controls['tarif'].errors && form.controls['tarif'].errors['required']">
                            Заполните поле
                        </p>
                    </div>
                </fieldset>


                <fieldset>
                    <label htmlFor="place_start">Место выдачи</label>
                    <select id="place_start" formControlName="place_start"
                        [ngClass]="{'invalid': form.controls['place_start'].invalid && form.controls['place_start'].touched}"
                        (ngModelChange)="placeStart($event)">
                        <option value="" disabled selected>Выбрать ↷</option>
                        <option value="Офис">Офис</option>
                        <option value="Аэропорт">Аэропорт</option>
                        <option value="Ж/д вокзал">Ж/д вокзал</option>
                        <option value="ТЦ Кристалл">ТЦ Кристалл</option>
                        <option value="Тц Сити Молл">Тц Сити Молл</option>
                    </select>
                
                
                    <div class="errorValidate" *ngIf="form.controls['place_start'].invalid && form.controls['place_start'].touched">
                        <p *ngIf="form.controls['place_start'].errors && form.controls['place_start'].errors['required']">
                            Заполните поле
                        </p>
                    </div>
                </fieldset>


                <fieldset>
                    <label htmlFor="place_end">Место приема</label>
                    <select id="place_end" formControlName="place_end"
                        [ngClass]="{'invalid': form.controls['place_end'].invalid && form.controls['place_end'].touched}"
                        (ngModelChange)="placeEnd($event)">
                        <option value="" disabled selected>Выбрать ↷</option>
                        <option value="Офис">Офис</option>
                        <option value="Аэропорт">Аэропорт</option>
                        <option value="Ж/д вокзал">Ж/д вокзал</option>
                        <option value="ТЦ Кристалл">ТЦ Кристалл</option>
                        <option value="Тц Сити Молл">Тц Сити Молл</option>
                    </select>
                
                
                    <div class="errorValidate" *ngIf="form.controls['place_end'].invalid && form.controls['place_end'].touched">
                        <p *ngIf="form.controls['place_end'].errors && form.controls['place_end'].errors['required']">
                            Заполните поле
                        </p>
                    </div>
                </fieldset>

                
            </div>

            <div>
                <fieldset>
                    <label htmlFor="tarif">Произвольный залог</label>
                    <div style="display: flex; height: 43px; margin-top: 5px;">
                        <p-checkbox formControlName="custome_zalog" (click)="customeZalogCheck()" value="true" inputId="custome_zalog"></p-checkbox>

                        <input *ngIf="this.booking.custome_zalog" type="text" placeholder="Введите сумму" formControlName="custome_zalog_value" id="custome_zalog_value" style="margin-left: 15px;
                        display: inline-block; margin-top: 0;" (change)="customeZalogValue($event)">
                    </div>
                </fieldset>
            </div>
        </div>

        <button type="submit" class="submit" [disabled]="form.invalid"><i class="pi pi-check"></i> Сохранить</button>
    </form>
</div>