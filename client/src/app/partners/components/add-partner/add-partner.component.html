<app-header-app-layout [title]="title"></app-header-app-layout>
<p-toast></p-toast>
<loader *ngIf="isLoadingSelector$ | async"></loader>



<div class="add-partner">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div>
            <div class="add_partner_inputs">
                <fieldset>
                    <label htmlFor="fio">ФИО</label>
                    <input pInputText id="fio" formControlName="fio" placeholder="Введите ФИО"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['fio'].invalid && form.controls['fio'].touched}"  style="width: 300px;"/>
                
                
                    <div class="errorValidate" *ngIf="form.controls['fio'].invalid && form.controls['fio'].touched">
                        <p *ngIf="form.controls['fio'].errors && form.controls['fio'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="passport_seria_number">Серия и номер паспорта</label>
                        <p-inputMask   id="passport_seria_number" formControlName="passport_seria_number" placeholder="Серия и номер" mask="9999-999999"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['passport_seria_number'].invalid && form.controls['passport_seria_number'].touched}"></p-inputMask>
                
                
                    <div class="errorValidate" *ngIf="form.controls['passport_seria_number'].invalid && form.controls['passport_seria_number'].touched">
                        <p *ngIf="form.controls['passport_seria_number'].errors && form.controls['passport_seria_number'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="passport_date">Дата выдачи паспорта</label>
                    <input type="date" pInputText id="passport_date" formControlName="passport_date" placeholder="Введите значение"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['passport_date'].invalid && form.controls['passport_date'].touched}"/>
                
                
                    <div class="errorValidate" *ngIf="form.controls['passport_date'].invalid && form.controls['passport_date'].touched">
                        <p *ngIf="form.controls['passport_date'].errors && form.controls['passport_date'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="passport_who_take">Кем выдан пасспорт</label>
                    <input pInputText id="passport_who_take" formControlName="passport_who_take" placeholder="Введите значение"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['passport_who_take'].invalid && form.controls['passport_who_take'].touched}" />
                
                
                    <div class="errorValidate" *ngIf="form.controls['passport_who_take'].invalid && form.controls['passport_who_take'].touched">
                        <p *ngIf="form.controls['passport_who_take'].errors && form.controls['passport_who_take'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="code_podrazdeleniya">Код подразделения</label>                        
                        <p-inputMask mask="999-999" id="code_podrazdeleniya" formControlName="code_podrazdeleniya" placeholder="999-999"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['code_podrazdeleniya'].invalid && form.controls['code_podrazdeleniya'].touched}"></p-inputMask>
                
                
                    <div class="errorValidate"
                        *ngIf="form.controls['code_podrazdeleniya'].invalid && form.controls['code_podrazdeleniya'].touched">
                        <p *ngIf="form.controls['code_podrazdeleniya'].errors && form.controls['code_podrazdeleniya'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="passport_register">Регистрация</label>
                    <input pInputText id="passport_register" formControlName="passport_register"
                        placeholder="Введите значение"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['passport_register'].invalid && form.controls['passport_register'].touched}" />
                
                
                    <div class="errorValidate"
                        *ngIf="form.controls['passport_register'].invalid && form.controls['passport_register'].touched">
                        <p
                            *ngIf="form.controls['passport_register'].errors && form.controls['passport_register'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="phone_1">Телефон(Основной)</label>

                    <p-inputMask mask="+7(999)-999-99-99" id="phone_1" formControlName="phone_1" placeholder="+7(999)999-99-99"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['phone_1'].invalid && form.controls['phone_1'].touched}"></p-inputMask>
                        
                    
                
                    <div class="errorValidate"
                        *ngIf="form.controls['phone_1'].invalid && form.controls['phone_1'].touched">
                        <p *ngIf="form.controls['phone_1'].errors && form.controls['phone_1'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                <fieldset>
                    <label htmlFor="phone_1">Телефон(Дополнительный)</label>


                    <p-inputMask mask="+7(999)-999-99-99" id="phone_2" formControlName="phone_2" placeholder="+7(999)999-99-99"
                        [ngClass]="{'ng-invalid ng-dirty': form.controls['phone_2'].invalid && form.controls['phone_2'].touched}"></p-inputMask>
                
                
                    <div class="errorValidate"
                        *ngIf="form.controls['phone_2'].invalid && form.controls['phone_2'].touched">
                        <p *ngIf="form.controls['phone_2'].errors && form.controls['phone_2'].errors['required']">
                            Поле не должно быть пустым
                        </p>
                    </div>
                </fieldset>

                
            </div>

            <div class="add_partner_images">
                <div class="file_1">
                    <img [src]="[file_1]" alt="Изображение"  >


                    <div class="upload_btns">
                        <input type="file" class="dn" #upload_1 (change)="onFile1Upload($event)">
                        <p-button label="Изменить" icon="pi pi-cloud-upload" styleClass="p-button-warning p-button-sm"
                            (click)="onFile1UploadClick()"></p-button>
                    </div>
                    
                </div>

                <div class="file_2">
                    <img [src]="[file_2]" alt="Изображение">

                    
                    <div class="upload_btns">
                        <input type="file" class="dn" #upload_2 (change)="onFile2Upload($event)">
                        <p-button label="Изменить" icon="pi pi-cloud-upload" styleClass="p-button-warning p-button-sm"
                            (click)="onFile2UploadClick()"></p-button>
                    </div>
                </div>



                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-md-6">
                            <div
                                class="droparea"
                                (dragover)="onDragOver($event)"
                                (drop)="onDrop($event)"
                                (dragleave)="onDragLeave($event)"
                                [class.active]="isActive"
                            >
                                <input type="file" name="userfiles" class="browse-file" (change)="onSelectedFile($event)" multiple/>
                                <h4>Choose files or <br /> Drag and drop files here</h4>
                            </div>
                            <div class="mt-2" *ngIf="upload.progress > 0 && upload.progress != 100">
                                <div class="progress" style="height: 20px;margin-bottom:20px;">
                                  <div class="progress-bar progress-bar-striped bg-info" role="progressbar" [style.width.%]="upload.progress" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">{{upload.progress}}%</div>
                                </div>
                            </div>
                            <div class="card mt-3 file-list">
                                <div class="card-header">File List</div>
                                <ul class="list-group list-group-flush" >
                                    <ng-container  *ngFor="let item of upload.files">
                                        <li class="list-group-item">{{item}} - Status: <span>Upload complete</span></li>
                                    </ng-container>
                                </ul>
                            </div>

                            <ng-container  *ngFor="let src of filesSrc; let i = index">
                                <div>
                                    <img *ngIf="src" [src]="[src]" alt="Изображение"  style="width: 100px;"> 
                                    <span>{{this.uploadFiles[i].name}}</span>
                                    <span>{{this.formatFileSize(this.uploadFiles[i].size)}}</span>
                                    <span *ngIf="src" (click)="onDeleteUploadInList(i)">Удалить</span>

                                </div>
                            </ng-container>

                            
                        </div>
                    </div>
                </div>


            </div>
        </div>

        <button type="submit" class="submit" [disabled]="form.invalid"><i class="pi pi-check"></i> Сохранить</button>
    </form>
</div>